import{r as q,a7 as f,$ as h,a0 as x,c as o,a9 as u,F as T,a4 as P,a2 as N,a6 as B,v as j,a1 as F,u as k,ad as E,a8 as M,a5 as O,f as R,m as z,w as H,o as Y,K as S}from"./@vue-9926d340.js";import{_ as V,r as w}from"./index-60949b5a.js";import{M as J,m as L}from"./ant-design-vue-01be3039.js";import{N as Q,f as W}from"./@ant-design-2dc0aa31.js";import{d as X,s as G}from"./pinia-b4aeb200.js";import"./vue-router-c96a8d72.js";import"./mitt-dab1f1cb.js";import"./axios-f45f83e3.js";import"./nprogress-7c12677d.js";import"./@babel-fff5462b.js";import"./vue3-colorpicker-2b62a1f5.js";import"./@vueuse-f8675665.js";import"./tinycolor2-8fe94c9b.js";import"./gradient-parser-8ea7f2ac.js";import"./@aesoper-129a60c8.js";import"./lodash-es-6d6f457b.js";import"./@popperjs-898015e8.js";import"./@ctrl-7f4e908e.js";import"./vue-demi-5b9a0fa5.js";import"./resize-observer-polyfill-c24c855f.js";import"./vue-types-932461d1.js";import"./dom-align-de4ed2f2.js";import"./dayjs-332804ad.js";import"./async-validator-efc2d198.js";import"./scroll-into-view-if-needed-90d8f7af.js";import"./compute-scroll-into-view-72df79c3.js";const Z={class:"list"},ee=["onDragenter","onDragover","onDragstart","onClick"],te={class:"add-item"},ae={__name:"DragList",props:{list:{required:!0,type:Array},activeId:{required:!0,type:String}},emits:["update:activeId","handleUpdate","handleAddClass","handleDelete"],setup(e,{emit:t}){const a=e,r=t,n=q("");function g(){r("handleAddClass",n.value),n.value=""}let s,m=!1;const p=q(!1);function D(l){s=l}function c(l,_){if(l.preventDefault(),s!==_){const C=a.list[s];a.list.splice(s,1),a.list.splice(_,0,C),s=_,m=!0}}function y(l,_){l.preventDefault()}function b(l){l.preventDefault(),m&&(r("handleUpdate"),m=!1),p.value=!1}function d(l){l.preventDefault();const _=a.list[s].id;J.confirm({title:"Confirm",icon:o(W),content:"\u786E\u8BA4\u5220\u9664\u5417",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk(){r("handleDelete",_)},onCancel(){}})}function i(l){l.preventDefault(),p.value=!0}function v(l){l.preventDefault(),p.value=!1}function U(l){r("update:activeId",l)}return(l,_)=>{const C=f("a-input");return h(),x("ul",Z,[o(j,{name:"drag",class:"list",tag:"ul"},{default:u(()=>[(h(!0),x(T,null,P(a.list,(I,A)=>(h(),x("li",{key:I.id,class:N(["list-item",{active:I.id===e.activeId}]),onDragenter:$=>c($,A),onDragover:$=>y($,A),onDragstart:$=>D(A),onDragend:b,draggable:"true",onClick:$=>U(I.id)},B(I.title),43,ee))),128))]),_:1}),F("li",{class:N(["list-item trashbin",{active:p.value}]),onDrop:d,onDragover:i,onDragleave:v},[o(k(Q))],34),F("li",te,[o(C,{value:n.value,"onUpdate:value":_[0]||(_[0]=I=>n.value=I),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u5206\u7C7B\u540D\u79F0",onKeydown:E(g,["enter"])},null,8,["value"])])])}}};var se=V(ae,[["__scopeId","data-v-7745195d"]]);const ne=["href"],ie=["onClick"],le=F("a",null,"\u5220\u9664",-1),oe={__name:"LinkTable",props:{list:{type:Array,required:!0}},emits:["handleDelete","handleModify"],setup(e,{emit:t}){const a=[{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u5730\u5740",dataIndex:"url",key:"url"},{title:"\u64CD\u4F5C",key:"command"}],r=e,n=t;return(g,s)=>{const m=f("a-divider"),p=f("a-popconfirm"),D=f("a-table");return h(),M(D,{columns:a,"data-source":r.list},{bodyCell:u(({column:c,record:y})=>[c.key==="url"?(h(),x("a",{key:0,href:y.url,target:"_blank"},B(y.url),9,ne)):O("",!0),c.key==="command"?(h(),x(T,{key:1},[F("a",{onClick:b=>{n("handleModify",y)}},"\u4FEE\u6539",8,ie),o(m,{type:"vertical"}),o(p,{title:"\u786E\u8BA4\u5220\u9664?","ok-text":"Yes","cancel-text":"No",onConfirm:b=>n("handleDelete",y.id)},{default:u(()=>[le]),_:2},1032,["onConfirm"])],64)):O("",!0)]),_:1},8,["data-source"])}}},re=()=>w.get("/link/class"),de=e=>w.get(`/link/list/${e}`),ce=e=>w.post("/link/add/class",{title:e}),ue=e=>w.post("/link/add",e),me=e=>w.get(`/link/delete/class/${e}`),pe=e=>w.get(`/link/delete/${e}`),fe=e=>w.post("/link/pos",{list:e}),ve=e=>w.post("/link/update",e),K=X("link",{state:()=>({classList:[],activeId:"",linkList:[],classLoading:!1,linkLoading:!1,modifyForm:null}),getters:{activeTitle(e){const t=e.classList.find(a=>a.id===e.activeId);return(t==null?void 0:t.title)||"\u672A\u9009\u62E9\u5206\u7C7B"}},actions:{async getLinkClassList(){this.classLoading=!0;const e=await re();this.classLoading=!1,e.code===1&&(this.classList=e.data)},async getLinkList(){this.linkLoading=!0;const e=await de(this.activeId);this.linkLoading=!1,e.code===1&&(this.linkList=e.data)},async updateClassPos(){await fe(this.classList)},async uploadClass(e){const t=await ce(e);t.code===1?(this.getLinkClassList(),L.success(t.message)):L.error(t.message)},async deleteLinkClass(e){var a;const t=await me(e);t.code===1?(this.getLinkClassList(),L.success(t.message),e===this.activeId&&(this.activeId=(a=this.classList[0])==null?void 0:a.id)):L.error(t.message)},async deleteLink(e){const t=await pe(e);t.code===1?(L.success(t.message),this.getLinkList()):L.error(t.message)}}}),_e={__name:"LinkModal",props:{visible:{required:!0,type:Boolean},modifyForm:{type:Object,default:{}}},emits:["update:visible","update:modifyForm"],setup(e,{emit:t}){const a=e,r=t,n=q(!1),g=q(null),s=R({id:"",name:"",url:""}),m=z(()=>s.id===""?"\u65B0\u589E\u94FE\u63A5":"\u4FEE\u6539\u94FE\u63A5");H(()=>a.modifyForm,()=>{var d;(d=a.modifyForm)!=null&&d.id&&(s.id=a.modifyForm.id,s.name=a.modifyForm.name,s.url=a.modifyForm.url)}),H(n,()=>{n.value===!1&&(s.id="",s.name="",s.url="",r("update:modifyForm",null)),r("update:visible",n.value)}),H(()=>a.visible,()=>{n.value=a.visible});const p=K(),{activeId:D}=G(p);async function c(){try{const d=await g.value.validate();s.id===""?await y(d):await b(d)}catch{}}async function y(d){const i=await ue({...d,classId:D.value});i.code===1?(L.success(i.message),await p.getLinkList(),n.value=!1):L.error(i.message)}async function b(d){const i=await ve({...d,id:s.id});i.code===1?(L.success(i.message),await p.getLinkList(),n.value=!1):L.error(i.message)}return(d,i)=>{const v=f("a-input"),U=f("a-form-item"),l=f("a-form"),_=f("a-modal");return h(),M(_,{visible:n.value,"onUpdate:visible":i[2]||(i[2]=C=>n.value=C),title:m.value,onOk:c,"ok-text":"\u4E0A\u4F20","cancel-text":"\u53D6\u6D88"},{default:u(()=>[o(l,{model:s,ref_key:"form",ref:g},{default:u(()=>[o(U,{label:"\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u94FE\u63A5\u540D\u79F0"}]},{default:u(()=>[o(v,{value:s.name,"onUpdate:value":i[0]||(i[0]=C=>s.name=C),placeholder:"\u8F93\u5165\u94FE\u63A5\u540D\u79F0"},null,8,["value"])]),_:1}),o(U,{label:"\u5730\u5740",name:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u94FE\u63A5\u5730\u5740"}]},{default:u(()=>[o(v,{value:s.url,"onUpdate:value":i[1]||(i[1]=C=>s.url=C),placeholder:"\u8F93\u5165\u94FE\u63A5\u5730\u5740"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}};const ke={class:"links"},ge={__name:"Links",setup(e){const t=K(),{classList:a,activeId:r,linkList:n,modifyForm:g,activeTitle:s}=G(t);Y(async()=>{await t.getLinkClassList(),a.value.length>0&&!r.value&&(r.value=a.value[0].id)}),H(r,()=>{t.getLinkList()});const m=q(!1);function p(D){g.value=D,m.value=!0}return(D,c)=>{const y=f("a-empty"),b=f("a-card"),d=f("a-col"),i=f("a-row");return h(),x("div",ke,[o(i,{justify:"space-around"},{default:u(()=>[o(d,{span:10},{default:u(()=>[o(b,{title:"\u94FE\u63A5\u5206\u7C7B",bordered:!1},{default:u(()=>[k(a).length===0?(h(),M(y,{key:0})):(h(),M(se,{key:1,list:k(a),activeId:k(r),"onUpdate:activeId":c[0]||(c[0]=v=>S(r)?r.value=v:null),onHandleUpdate:k(t).updateClassPos,onHandleAddClass:k(t).uploadClass,onHandleDelete:k(t).deleteLinkClass},null,8,["list","activeId","onHandleUpdate","onHandleAddClass","onHandleDelete"]))]),_:1})]),_:1}),o(d,{span:13},{default:u(()=>[o(b,{title:k(s),bordered:!1},{extra:u(()=>[F("a",{onClick:c[3]||(c[3]=v=>m.value=!0)},"\u65B0\u589E")]),default:u(()=>[o(_e,{visible:m.value,"onUpdate:visible":c[1]||(c[1]=v=>m.value=v),modifyForm:k(g),"onUpdate:modifyForm":c[2]||(c[2]=v=>S(g)?g.value=v:null)},null,8,["visible","modifyForm"]),o(oe,{onHandleModify:p,list:k(n),onHandleDelete:k(t).deleteLink},null,8,["list","onHandleDelete"])]),_:1},8,["title"])]),_:1})]),_:1})])}}};var Ee=V(ge,[["__scopeId","data-v-6299a1b4"]]);export{Ee as default};
